# 超卖问题



预扣库存。先扣除了库存，保证不超卖，然后**异步生成用户订单**，这样响应给用户的速度就会快很多,减少数据库瞬时压力

库存数量分配到多机上,减少单机压力 hash route

每台机器预留部分多余库存,防止机器宕机容错,扣库存为本机和Redis是同个事务

Redis统一总库存,当单机库存告罄后可直接响应失败,不需访问redis

订单进度的查看，每台服务器上都有一个任务，定时的从总库存同步余票和库存信息展示给用户

订单支付过期后释放订单，补充库存

